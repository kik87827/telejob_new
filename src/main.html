<!DOCTYPE html>
<html lang="ko">
  @@include('./include/head.html')
  <body class="front_body">
    <div class="page_wrap main">
      @@include('./include/header.html')
      <!-- middle -->
      <section class="middle_wrap">
        <!-- prettier-ignore -->
        @@include('mv.html')
        <div class="main_contents_section">
          <!-- prettier-ignore -->
          @@include('main_premium.html') 
          @@include('main_plusbox.html') 
          @@include('main_focusbox.html') 
          @@include('main_recbox.html') 
          @@include('main_top10_com.html') 
          @@include('main_text_recdata.html')
          <!-- prettier-ignore -->
        </div>
        @@include('main_customer.html')
      </section>
      <!-- // middle -->
      <!-- popup -->
      <div class="popup_wrap scroll_type" id="noticeMainPopup">
        <div class="bg_dim"></div>
        <div class="popup_box_tb_wrap">
          <div class="popup_box_tb">
            <div class="popup_box_td">
              <div class="notice_banner_layer">
                <div class="control_row">
                  <div class="control_cols">
                    <div class="props_item">
                      <input type="checkbox" class="props_dom" id="notice_today" />
                      <label for="notice_today" class="props_label">오늘 하루 보지 않기</label>
                    </div>
                  </div>
                  <div class="control_cols">
                    <a href="javascript:;" class="btn_card close_trigger">
                      <i class="ico close"></i>
                      <span class="text_node">닫기</span>
                    </a>
                  </div>
                </div>
                <div class="img_row">
                  <div class="swiper notice_banner_swiper">
                    <div class="swiper-wrapper">
                      <div class="swiper-slide">
                        <a href="#" class="notice_banner_item"><img src="./assets/images/main_notice_banner.jpg" alt="" /></a>
                      </div>
                      <div class="swiper-slide">
                        <a href="#" class="notice_banner_item"><img src="./assets/images/main_notice_banner02.jpg" alt="" /></a>
                      </div>
                      <div class="swiper-slide">
                        <a href="#" class="notice_banner_item"><img src="./assets/images/main_notice_banner03.jpg" alt="" /></a>
                      </div>
                      <div class="swiper-slide">
                        <a href="#" class="notice_banner_item"><img src="./assets/images/main_notice_banner04.jpg" alt="" /></a>
                      </div>
                      <div class="swiper-slide">
                        <a href="#" class="notice_banner_item"><img src="./assets/images/main_notice_banner05.jpg" alt="" /></a>
                      </div>
                    </div>
                    <div class="swiper-pagination"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- // popup -->
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          // main right banner
          mvSticky();

          // main tape banner
          var slideCount = 0;
          groupItemsIntoSlides(".mv_tapebanner_item", ".swiper .swiper-wrapper", 3);
          slideCount = document.querySelectorAll(".mv_tapbanner_container .swiper-slide").length;
          // 슬라이드가 1개 초과일 때만 Swiper 실행
          var mvTapebanner = null;
          if (slideCount > 1) {
            mvTapebanner = new Swiper(".mv_tapbanner_container", {
              speed: 500,
              loop: true,
              autoplay: {
                delay: 4000,
                disableOnInteraction: false,
              },
            });
          }

          // main banner
          let mv_banner = new Swiper(".mv_cardbanner_wrap", {
            loop: true,
            speed: 500,
            autoplay: {
              delay: 4000,
              disableOnInteraction: false,
            },
            pagination: {
              el: ".mv_fraction_wrap",
              type: "fraction",
              renderFraction: function (currentClass, totalClass) {
                // 여기에서 직접 원하는 구조로 조합
                return `
                  <span class="${currentClass}"></span><span class="slash">/</span><span class="${totalClass}"></span>
                `;
              },
            },
          });
          const autobtn = document.querySelector(".btn_mv_timer.auto");
          const stopbtn = document.querySelector(".btn_mv_timer.stop");
          autobtn.addEventListener("click", (e) => {
            e.preventDefault();
            e.currentTarget.style.display = "none";
            stopbtn.style.display = "block";
            mv_banner.autoplay.start();
          });
          stopbtn.addEventListener("click", (e) => {
            e.preventDefault();
            e.currentTarget.style.display = "none";
            autobtn.style.display = "block";
            mv_banner.autoplay.stop();
          });

          // 우수기업 전용채용관 250822
          let usuTapeSwiper = new Swiper(".sync_vertical_wrap.swiper", {
            loop: true,
            direction: "vertical",
            speed: 500,
            autoplay: {
              delay: 3000,
              disableOnInteraction: false,
            },
          });

          // 인스턴스 선언
          let noticeMainPopup = new DesignPopup({
            selector: "#noticeMainPopup",
            beforeCallback() {},
            callback() {},
            closeCallback() {},
          });
          // noticeMainPopup.popupShow(); // show
          // noticeMainPopup.popupHide(); // hide

          // 공지 팝업 swiper 선언
          let noticeSwiper = new Swiper(".notice_banner_swiper", {
            loop: true,
            speed: 500,
            autoplay: {
              delay: 3000,
              disableOnInteraction: false,
            },
            pagination: {
              el: ".swiper-pagination",
              clickable: true, // 사용자가 페이지 버튼 클릭 가능
            },
          });

          // 오늘하루보지 않기
          const notice_today = document.getElementById("notice_today");
          const todayKey = "todayPopup";
          // 오늘 날짜 (YYYY-MM-DD)
          const today = new Date().toISOString().split("T")[0];
          const storedDate = localStorage.getItem(todayKey);
          notice_today.addEventListener("click", (e) => {
            if (e.currentTarget.checked && notice_today.checked) {
              localStorage.setItem(todayKey, today);
            }
          });

          // 퍼블확인용
          let url = window.location.href.split("?")[1];
          let url_2 = url !== undefined ? url.split("#")[0] : null;
          if (url_2 === "notice_popup") {
            // 오늘 하루 보지 않기
            if (storedDate !== today) {
              noticeMainPopup.popupShow({
                openCallback() {
                  noticeSwiper.update();
                },
              });
            }
          }
        });

        // 250822 스크립트 추가(3개씩 묶기)
        function groupItemsIntoSlides(itemSelector = ".mv_tapebanner_item", wrapperSelector = ".swiper.mv_tapbanner_container .swiper-wrapper", perSlide = 3) {
          const wrapper = document.querySelector(wrapperSelector);
          if (!wrapper) return;

          const items = Array.from(document.querySelectorAll(itemSelector));
          if (items.length === 0) return;

          // 기존 wrapper 비우기
          wrapper.innerHTML = "";

          // perSlide 개씩 묶어서 슬라이드 생성
          for (let i = 0; i < items.length; i += perSlide) {
            const slide = document.createElement("div");
            slide.className = "swiper-slide";

            const chunk = items.slice(i, i + perSlide);
            chunk.forEach((el) => slide.appendChild(el));

            wrapper.appendChild(slide);
          }
        }
      </script>
      @@include('./include/footer.html')
    </div>
  </body>
</html>
